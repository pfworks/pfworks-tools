#!/usr/bin/env python3
"""
QIS v6.0 - Universal Cross-Platform Launcher
Automatically detects platform and uses appropriate launch method
"""

import sys
import os
import platform
import subprocess

def main():
    """Universal launcher that detects platform and uses best method"""
    system_name = platform.system().lower()
    
    print("QIS v6.0 - Universal Cross-Platform Launcher")
    print("=" * 50)
    print(f"Detected platform: {platform.system()}")
    
    # Get script directory
    script_dir = os.path.dirname(os.path.abspath(__file__))
    os.chdir(script_dir)
    
    if system_name == 'windows':
        print("Using Windows launcher...")
        # Try Python launcher first (best for Windows)
        try:
            subprocess.run([sys.executable, 'launch_qis.py'], check=True)
        except:
            # Fallback to batch file
            try:
                subprocess.run(['QIS.bat'], shell=True, check=True)
            except:
                # Final fallback
                subprocess.run([sys.executable, 'qis_v6.py'])
    else:
        # Linux or macOS
        print(f"Using Unix launcher for {system_name}...")
        try:
            # Try Python launcher first
            subprocess.run([sys.executable, 'launch_qis.py'], check=True)
        except:
            # Fallback to shell script
            try:
                subprocess.run(['./launch_qis.sh'], check=True)
            except:
                # Final fallback
                subprocess.run([sys.executable, 'qis_v6.py'])

if __name__ == "__main__":
    main()
